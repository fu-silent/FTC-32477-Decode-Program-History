# v2.3 vs v2.2 功能对比

## 核心改进：无头模式 (Field-Centric)

| 方面 | v2.2 | v2.3 (最新) |
|---|---|---|
| **驱动模式** | 有头模式 (Robot-Centric) | **有头/无头模式切换** |
| **操控直观性** | 依赖车头方向 | **始终以场地为参考** |
| **IMU 校准** | 仅初始化时 | **可随时重置航向** |
| **核心按键** | X 键无功能 | **X 键切换有头/无头** |
| | Back 键无功能 | **Back 键重置 IMU** |

---

## 详细对比

### 1. 驱动模式：革命性升级

**v2.2 (有头模式)**：
-   向前推摇杆，机器人总是朝**车头方向**移动。
-   当地面情况复杂，车头方向不断变化时，司机需要不断调整自己的操作参考系，增加了操作难度。

**v2.3 (无头模式)** ✨：
-   **新增无头模式**，通过 **X 键** 切换。
-   在无头模式下，向前推摇杆，机器人总是朝**场地前方**（司机视角的前方）移动，无论车头朝向哪里。
-   极大降低了驾驶员的操作负担，尤其是在快速移动和躲避障碍时。

### 2. IMU 航向重置：随时校准

**v2.2**：
-   IMU 的“0度角”在程序初始化时设定，无法在比赛中更改。

**v2.3**：
-   新增 **IMU 航向重置**功能，通过 **Back/Options 键**触发。
-   在比赛的任何时刻，都可以将机器人当前朝向设置为新的“0度角”（即场地前方），方便校准无头模式。

### 3. 按键映射与遥测

**v2.2 按键**
```
Y = 切换线性/非线性
RT = 发射
RB = 自动转向
D-Pad = 档位选择
A/B/LT/LB = 拾取/装填
```

**v2.3 按键**
```
Y = 切换线性/非线性
X = 切换有头/无头模式 ✨
Back = 重置IMU航向 ✨
RT = 发射
RB = 自动转向
D-Pad = 档位选择
A/B/LT/LB = 拾取/装填
```

**遥测显示**：
-   v2.3 的“驱动模式”字段会显示 **有头 (Robot) / 无头 (Field)** 状态。
-   按键说明已更新，包含 X 和 Back 键的功能。

---

## 什么时候用 v2.2 vs v2.3？

| 场景 | 选择 | 理由 |
|---|---|---|
| **所有竞赛场景** | **v2.3** | **无头模式极大提升驾驶效率和容错率** |
| 新手司机训练 | v2.3 | 从一开始就适应最高效的控制方式 |
| 学习 v2.2 功能 | v2.2 | 如果想隔离学习，可以参考 v2.2 |

---

## 🔧 代码级别对比 (v2.3 关键改动)

### 1. `ChassisDriveSystem_2_3.java`
-   **构造函数**：增加了 `NavigationSystem_2_3` 作为依赖，用于获取实时航向角。
-   **`update()` 方法**：增加了“无头模式坐标转换”的数学逻辑，在应用麦克纳姆轮解算前，将摇杆输入从场地坐标系旋转到机器人坐标系。
-   **`toggleCentricMode()`**：新增方法，用于切换 `isFieldCentric` 状态。

### 2. `NavigationSystem_2_3.java`
-   **`resetYaw()`**：新增方法，封装了 `imu.resetYaw()`，允许在运行时调用。

### 3. `ControlInputManager_2_3.java`
-   **`isXButtonPressed()`**：新增方法，用于边缘检测 X 键。
-   **`isOptionsPressed()`**：新增方法，用于边缘检测 Back/Options 键。

### 4. `TeleOp_2_3.java` (主程序)
-   **初始化**：调整了模块初始化顺序，确保 `Navigation` 在 `ChassisDrive` 之前创建。
-   **主循环**：增加了对 X 和 Back 键的检测，并调用相应模块的方法。

---

## 🎯 总结

✅ **v2.3 是基于 v2.2 的一次重大体验升级，强烈推荐用于所有比赛和训练。**

-   **驾驶更简单**：无头模式让司机摆脱了车头方向的束缚。
-   **校准更灵活**：随时重置 IMU，适应各种场地情况。
-   **功能全兼容**：保留了 v2.2 的所有优秀特性，如双模式底盘、震动反馈和优化的发射逻辑。

📅 更新：2025-12-12
