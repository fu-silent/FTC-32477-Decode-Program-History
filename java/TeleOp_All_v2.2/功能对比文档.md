# v2.2 vs v2.1 功能对比

## 核心改进

| 方面 | v2.1 | v2.2 |
|------|------|------|
| 底盘模式 | 仅线性 | **线性/非线性切换** |
| 手柄反馈 | 无 | **设置转速时震动** |
| 发射逻辑 | D-Pad设转速，RT启动 | **D-Pad设转速(震动)+RT按住启动/松开怠速** |
| 遥测信息 | 基础 | **全面增强** |

---

## 详细对比

### 底盘控制

**v2.1**：只有线性驱动模式。  
**v2.2**：新增线性/非线性（平方）驱动模式切换，通过 **Y 键** 进行切换，非线性模式在低速时提供更精细的控制。

### 发射系统交互

**v2.1**：D-Pad 设置转速后，发射模块立即启动（如果 `isShooting` 为 `true`），右扳机控制 `isShooting` 状态。  
**v2.2**：D-Pad 设置转速时，**手柄会震动** 进行触觉反馈，发射模块不会立即启动。只有**按住右扳机 (RT)** 时，发射模块才会启动并维持目标转速；松开右扳机，发射模块会停止（怠速）。

### 遥测信息

**v2.1**：遥测信息相对简洁，主要显示运行时间、目标转速、当前转速、转速达标状态、航向、自动转向状态。  
**v2.2**：遥测信息全面增强，包括：
*   运行时间
*   目标转速
*   S1 电机实时转速
*   S2 电机实时转速
*   转速是否达标
*   底盘当前移动模式 (线性/非线性)
*   装填模块状态
*   拾取模块状态
*   当前航向
*   自动转向状态
*   简短的按键说明

---

## 什么时候用 v2.1 vs v2.2？

| 场景 | 选择 | 理由 |
|------|------|------|
| 竞赛部署 | v2.2 | 增强的交互和控制，更全面的状态 |
| 学习研究 | v2.1 或 v2.2 | v2.1 基础功能更简单，v2.2 功能更全面 |
| 赛前调试 | v2.2 | 精准的底盘控制，直观的发射反馈 |

---

## 📈 性能对比

### 编译和部署

| 指标 | v2.1 | v2.2 |
|------|------|------|
| 编译时间 | 2-3 秒 | 2-3 秒 |
| 内存占用 | 1.0 MB | 1.0 MB |
| 文件数 | 8 个 | 8 个 |
| 代码行数 | 1200 行 | 1250 行 (略增) |

### 调试难度

| 方面 | v2.1 | v2.2 |
|------|------|------|
| 参数调节点 | 3 个 | 3 个 |
| 预期调试时间 | 20 分钟 | 25 分钟 |
| 记忆按键数 | 5 个（v1.0 回归） | 6 个（新增 Y 键） |
| 错误恢复难度 | 简单（独立测试） | 简单（独立测试） |

---

## 🔧 代码级别对比 (新增/修改的关键点)

### 1. `RobotConstants_2_2.java`

*   版本号更新为 `v2.2.0`。

### 2. `ChassisDriveSystem_2_2.java`

*   新增 `isNonLinearMode` 变量和 `toggleDriveMode()` 方法。
*   `update()` 方法中增加了根据 `isNonLinearMode` 进行输入平方处理的逻辑。
*   新增 `getDriveModeName()` 方法用于遥测。

### 3. `ControlInputManager_2_2.java`

*   新增 `rumble()` 方法用于触发手柄震动。
*   D-Pad 相关方法（`isShooterSpeedLongRangeRequested` 等）增加了边缘检测逻辑，确保每次按下只触发一次。

### 4. `SubsystemManager_2_2.java`

*   `setShooterTargetRPM()` 方法修改为仅设置目标转速，不再直接控制电机启动。
*   `setShootingState(boolean firing)` 方法用于根据右扳机状态启动或停止发射电机。
*   `updateShooterSpeed()` 方法根据 `isShooting` 状态决定是否将电机速度设置为目标转速或 0。
*   `getShooter1RPM()` 和 `getShooter2RPM()` 方法用于获取两个发射电机的独立转速。

### 5. `TelemetryManager_2_2.java`

*   `displayFullTelemetry()` 方法的参数列表和内容都已扩展，以显示所有新增的遥测信息。

### 6. `TeleOp_2_2.java` 和 `TeleOp_All_2_2.java`

*   更新了 `runOpMode()` 中的主循环逻辑，以适配底盘模式切换、发射逻辑优化和增强的遥测显示。

---

## 🎯 总结

✅ **v2.2 在 v2.1 的基础上，进一步提升了操作体验和状态可视性。**

- **驾驶体验更佳**：非线性底盘提供更精细的控制，手柄震动让操作反馈更及时。
- **发射控制更合理**：D-Pad 预设转速与扳机启动分离，操作更符合直觉。
- **调试更便捷**：全面的遥测信息有助于快速诊断问题。

📅 更新：2025-12-07

