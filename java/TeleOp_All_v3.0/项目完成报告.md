
# TeleOp v3.0 项目完成报告

✅ **v3.0 功能开发完成 100%**

v3.0 版本是对 v2.3 优秀基础的进一步深化和完善。该版本将控制程序从“功能聚合”提升到“**专业化分工与精度控制**”的新阶段，重点解决了 v2.3 在复杂环境下可能出现的兼容性问题，并为高强度竞赛提供了更精细的操作手段。

## 1. v3.0 对比 v2.3 的核心改进

| 改进项 | v2.3 (基础版) | v3.0 (增强版) |
|---|---|---|
| **航向重置机制** | Back 键单点重置 (存在 SDK 兼容性风险) | **D-Pad 多角度重置** (软件补偿实现，稳定可靠) |
| **自动瞄准功能** | 单一自动转向 (RB 键) | **双自动瞄准** (D1 A/B 键，预设两个目标) |
| **驾驶分工** | 隐式分工 | **显式 D1/D2 专业分工** |
| **瞄准精度** | D1 全速转向 | **D2 接管精确转向** (0.5x 速度) |
| **发射器清理** | 仅装填反转 (D1/D2 LB) | **新增 D2 RB 键 500 RPM 发射器反转** |

## 2. 设计理念与技术总结

### (1) 导航系统稳定化 (IMU 软件补偿)

-   **目标**：允许驾驶员在比赛中将航向角重置到 0°、±90°、180° 等标准角度，以快速校准无头模式。
-   **实现**：通过引入 **`yawOffset` 软件补偿量**，程序能够处理旧版 FTC SDK 不支持带参数 `imu.resetYaw()` 的问题。任何重置请求都会被转换为对 `yawOffset` 的修改，从而保证 `getHeading()` 始终是基于场地参考系的精确角度。

### (2) 驾驶员专业化分工

-   **目标**：最大化两个手柄的利用率，减少操作冲突，提升关键环节的控制精度。
-   **D2 精确控制**：将 D2 的右摇杆用于转向控制时，底盘输出速度被限制在 0.5x。这一设计专门服务于**瞄准阶段**，让 D2 能够在 D1 移动的同时进行微调，显著提高发射精度。
-   **独立清理**：赋予 D2 RB 键强制低速反转发射器的功能，作为专门的故障清理键，与正常的发射功能分离。

## 3. 保留的核心功能

-   **驱动模式**：完整保留 v2.3 引入的无头模式 (X 键切换) 和线性/非线性驱动模式 (Y 键切换)。
-   **高级发射系统**：继续采用 PIDF 速度控制电机，D-Pad 预设 RPM 档位，以及关键操作（模式切换、转速达标）的震动反馈机制。